
function register() {
    if (!window.PublicKeyCredential) { /* Client not capable of the API. Handle error. */ }
    const emailInput = document.querySelector('.email-address-input').value;

    console.log('first name: ', emailInput)

    PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()
        .then(function (uvpaAvailable) {
            if (uvpaAvailable) {
                return true;
            }
            return false;
        }).then( (userSaidYes) => {
        // If there is a user-verifying platform authenticator
        // AND the user wants to create a credential
        if (userSaidYes) {
            return navigator.credentials.create({ publicKey: {
                    // the challenge needs to be generated by the server
                    challenge: new Uint8Array([117, 61, 252, 231, 191, 241]),
                    // the relying party needs to come from server
                    // the id needs to match the domain
                    rp: { id: "localhost", name: "Some Tenant Name" },
                    user: {
                        id: new Uint8Array([79, 252, 83, 72, 214, 7, 89, 26]),
                        name: emailInput,
                        displayName: ""
                    },
                    pubKeyCredParams: [
                        {
                            type: "public-key",
                            alg: -7 // "ES256"
                        },
                        {
                            type: "public-key",
                            alg: -257 // "RS256"
                        }
                    ],
                    authenticatorSelection: {
                        userVerification: "required"
                    }
                } });
        }
        return;
    }).then(function (newCredentialInfo) {
        if (newCredentialInfo) {
            // Send new credential info to server for verification and registration.
            console.log('send new credential info', newCredentialInfo)
            console.log('')
        }
    }).catch(function (err) {
        // Something went wrong. Handle appropriately.
        console.log('there was an error', err)
    });
}
